<view class="container page-home">
  
  <view class="custom-nav" style="padding-top: {{statusBarHeight}}px; height: {{navBarHeight}}px;">
    <view class="nav-content">
      <view class="nav-left" bindtap="onSearch">
        <icon type="search" size="20" color="#1A1A1A"/>
      </view>
      <view class="nav-title">1956 | BUCM</view>
      <view class="nav-right"></view> </view>
  </view>

  <!-- 内容区 PaddingTop 只需要导航栏高度 -->
  <view class="scroll-content" style="padding-top: {{navHeaderHeight}}px;">
    
    <!-- 标签栏 -->
    <view class="tabs-section" style="top: {{stickyTop}}px; height: {{tabHeight}}px;">
      <scroll-view 
        scroll-x 
        class="tabs-scroll" 
        enable-flex 
        scroll-into-view="tab-{{currentTab > 2 ? currentTab - 2 : 0}}"
        show-scrollbar="{{false}}"
        scroll-with-animation
        enhanced
        fast-deceleration
      >
        <view class="tabs-container">
          <view 
            wx:for="{{tabs}}" 
            wx:key="id" 
            id="tab-{{index}}"
            class="tab-item {{currentTab === index ? 'active' : ''}}"
            bindtap="switchTab"
            data-index="{{index}}"
          >
            {{item.name}}
          </view>
          <view style="width: 80rpx; flex-shrink: 0;"></view>
        </view>
      </scroll-view>

      <view class="tabs-more-btn {{showChannelPopup ? 'open' : ''}}" bindtap="toggleChannelPopup">
        <view class="icon-chevron"></view>
      </view>
    </view>

    <!-- 频道弹窗 -->
    <view class="channel-popup-mask {{showChannelPopup ? 'show' : ''}}" bindtap="toggleChannelPopup" catchtouchmove="true">
      <view 
        class="channel-popup-body" 
        catchtap="stopProp"
        style="top: {{navHeaderHeight}}px;"
      >
        <view class="popup-header">
          <view class="popup-title-group">
            <text class="p-main-title">我的频道</text>
            <text class="p-sub-title">点击进入频道</text>
          </view>
          <view class="popup-edit-btn" catchtap="onEditChannels">编辑</view>
        </view>
        <view class="popup-grid">
          <view 
            wx:for="{{tabs}}" 
            wx:key="id" 
            class="popup-item {{currentTab === index ? 'active' : ''}}"
            bindtap="switchTab"
            data-index="{{index}}"
          >
            <text class="p-item-text">{{item.name}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 瀑布流：还原对称布局 -->
    <view class="waterfall-container">
      <view class="column">
        <block wx:for="{{leftList}}" wx:key="id">
          <neo-card title="{{item.title}}" cover="{{item.cover}}" nickname="{{item.nickname}}" likes="{{item.likes}}" isLiked="{{item.isLiked}}"/>
        </block>
      </view>
      <view class="column">
        <block wx:for="{{rightList}}" wx:key="id">
          <neo-card title="{{item.title}}" cover="{{item.cover}}" nickname="{{item.nickname}}" likes="{{item.likes}}" isLiked="{{item.isLiked}}"/>
        </block>
      </view>
    </view>

  </view>
</view>